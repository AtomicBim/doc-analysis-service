"""
Конфигурация для анализа документации
"""

# ============================================================
# STAGE 1: Извлечение метаданных из штампов и заголовков
# ============================================================
STAGE1_MAX_PAGES = 150  # Максимальное количество страниц для извлечения метаданных
STAGE1_DPI = 100  # Качество рендеринга для crops
STAGE1_QUALITY = 70  # JPEG качество для crops

# Области для извлечения (процент от размера страницы)
STAGE1_STAMP_CROP = {
    'left': 0.7,   # 70% от ширины (правый нижний угол)
    'top': 0.8,    # 80% от высоты
    'right': 1.0,  # 100% ширины
    'bottom': 1.0  # 100% высоты
}

STAGE1_TOP_RIGHT_CROP = {
    'left': 0.7,   # 70% от ширины (правый верхний угол)
    'top': 0.0,    # 0% от высоты
    'right': 1.0,  # 100% ширины
    'bottom': 0.15 # 15% высоты
}

STAGE1_HEADER_CROP = {
    'left': 0.0,   # 0% от ширины (весь заголовок)
    'top': 0.0,    # 0% от высоты
    'right': 1.0,  # 100% ширины
    'bottom': 0.1  # 10% высоты
}

# ============================================================
# STAGE 2: Оценка релевантности страниц (low-res)
# ============================================================
STAGE2_MAX_PAGES = 150  # Максимальное количество страниц для оценки релевантности
STAGE2_DPI = 100  # Качество рендеринга (низкое разрешение)
STAGE2_QUALITY = 70  # JPEG качество (низкое)
STAGE2_DETAIL = "low"  # OpenAI Vision detail level (85 tokens/image)

# ============================================================
# STAGE 3: Детальный анализ релевантных страниц (high-res)
# ============================================================
STAGE3_DPI = 150  # Качество рендеринга (высокое разрешение)
STAGE3_QUALITY = 85  # JPEG качество (высокое)
STAGE3_DETAIL = "high"  # OpenAI Vision detail level (765 tokens/image)
STAGE3_BATCH_SIZE = 4  # Количество требований в одном batch запросе
STAGE3_MAX_TOKENS = 4000  # Максимальное количество токенов в ответе

# ============================================================
# Классификация требований в батчи
# ============================================================
CLASSIFICATION_MIN_BATCHES = 3  # Минимальное количество батчей
CLASSIFICATION_MAX_BATCHES = 5  # Максимальное количество батчей

# ============================================================
# Retry и rate limiting
# ============================================================
RETRY_MAX_ATTEMPTS = 3  # Максимальное количество попыток при ошибке
RETRY_WAIT_EXPONENTIAL_MULTIPLIER = 1  # Множитель для экспоненциального backoff (секунды)
RETRY_WAIT_EXPONENTIAL_MAX = 10  # Максимальное время ожидания (секунды)

# ============================================================
# OpenAI API настройки
# ============================================================
OPENAI_MODEL = "gpt-4o"  # Модель для анализа
OPENAI_TEMPERATURE = 0.1  # Температура (0.0 = детерминированный, 1.0 = креативный)

# ============================================================
# Логирование
# ============================================================
LOG_LEVEL = "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_RESPONSE_PREVIEW_LENGTH = 200  # Длина preview ответа модели в логах
LOG_FULL_RESPONSE_ON_ERROR = True  # Логировать полный ответ при ошибке
