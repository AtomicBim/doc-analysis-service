# –ê–Ω–∞–ª–∏–∑ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –∫–æ–¥–∞

–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞: 10 –æ–∫—Ç—è–±—Ä—è 2025

## üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### ‚úÖ Backend (Python) - api-service/
- **–í—Å–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–π:** 24
- **–ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:** 1
- **–ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:** 1
- **–ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤:** 0

### ‚úÖ Frontend (React/TypeScript) - ui-react-service/
- **–ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:** 0
- **–ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª–µ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤:** 2
- **–ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤:** 0

---

## üî¥ –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. Backend (api-service/analysis_api_hybrid.py)

#### ‚ùå –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è `load_tu_prompts()` –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `TU_PROMPTS`

**–°—Ç—Ä–æ–∫–∏:** 96-116, 162

```python
def load_tu_prompts() -> Dict[str, str]:
    """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¢–£ –¥–ª—è —Å—Ç–∞–¥–∏–π –§–≠ –∏ –≠–ü."""
    # ... –∫–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ tu_fe.txt –∏ tu_ep.txt
    
TU_PROMPTS = load_tu_prompts()  # –°—Ç—Ä–æ–∫–∞ 162 - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, –Ω–æ –Ω–∏–≥–¥–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª—ã `prompts/tu_fe.txt` –∏ `prompts/tu_ep.txt`
- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `TU_PROMPTS` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–æ–¥–µ
- –§–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç–∏–ø–æ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è —Å—Ç–∞–¥–∏–π –§–≠ –∏ –≠–ü

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- **–í–∞—Ä–∏–∞–Ω—Ç 1 (—É–¥–∞–ª–∏—Ç—å):** –ï—Å–ª–∏ –¢–£ –Ω–µ –Ω—É–∂–Ω—ã - —É–¥–∞–ª–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∏ —Ñ–∞–π–ª—ã `tu_fe.txt`, `tu_ep.txt`
- **–í–∞—Ä–∏–∞–Ω—Ç 2 (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å):** –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –¢–£ –≤ –ø—Ä–æ—Ü–µ—Å—Å –∞–Ω–∞–ª–∏–∑–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö –∫ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∏–∑ –¢–ó)

---

### 2. Frontend (ui-react-service/src/)

#### ‚ö†Ô∏è –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤

##### a) –ü–æ–ª–µ `recommendations` –≤ —Ç–∏–ø–µ `Requirement`

**–§–∞–π–ª:** `ui-react-service/src/types.ts:10`

```typescript
export interface Requirement {
    // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
    recommendations: string;  // ‚ùå –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ frontend
    // ...
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–ª–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –≤ —Ç–∏–ø–µ
- Backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç—Ç–æ –ø–æ–ª–µ (–∑–∞–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö)
- Frontend –ù–ï –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç `recommendations` –Ω–∏–≥–¥–µ –≤ UI
- –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `RequirementList.tsx` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ: `status`, `confidence`, `solution_description`, `reference`, `discrepancies`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ backend:**
```python
# api-service/analysis_api_hybrid.py
recommendations="–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä—É—á–Ω—É—é"        # —Å—Ç—Ä–æ–∫–∞ 939
recommendations="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –∞–Ω–∞–ª–∏–∑"         # —Å—Ç—Ä–æ–∫–∞ 1004, 1070
recommendations="–ü–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ..."     # —Å—Ç—Ä–æ–∫–∞ 955
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- **–í–∞—Ä–∏–∞–Ω—Ç 1:** –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å `recommendations` –≤ UI (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Å–µ–∫—Ü–∏–∏ "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏")
- **–í–∞—Ä–∏–∞–Ω—Ç 2:** –£–¥–∞–ª–∏—Ç—å –ø–æ–ª–µ –∏–∑ —Ç–∏–ø–∞, –µ—Å–ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–µ –Ω—É–∂–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

---

##### b) –ü–æ–ª–µ `trace_id` –≤ —Ç–∏–ø–∞—Ö `Requirement` –∏ `EditableRequirement`

**–§–∞–π–ª—ã:** 
- `ui-react-service/src/types.ts:12`
- `ui-react-service/src/components/RequirementEditor.tsx:8`

```typescript
export interface Requirement {
    // ...
    trace_id?: string;  // ‚ùå –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
}

export interface EditableRequirement {
    // ...
    trace_id?: string;  // ‚ùå –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–ª–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ, –Ω–æ –Ω–∏–≥–¥–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ UI
- Backend –ø–µ—Ä–µ–¥–∞–µ—Ç —ç—Ç–æ –ø–æ–ª–µ, –Ω–æ frontend –µ–≥–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç
- –í–µ—Ä–æ—è—Ç–Ω–æ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏/–æ—Ç–ª–∞–¥–∫–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- **–í–∞—Ä–∏–∞–Ω—Ç 1:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (–æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –≤ dev mode)
- **–í–∞—Ä–∏–∞–Ω—Ç 2:** –£–¥–∞–ª–∏—Ç—å, –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)

### Backend
- ‚úÖ –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:
  - `asyncio` ‚Üí `asyncio.to_thread()` (4 –≤—ã–∑–æ–≤–∞)
  - `HTTPException` ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (14 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π)
  - `RateLimitError` ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ rate limit –æ—Ç OpenAI
  - `warnings` ‚Üí –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ deprecation warnings

- ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:
  - `extract_selected_pdf_pages_as_images()` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ analyze_documentation
  - `_extract_page_texts_quick()` ‚Üí —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø—Ä–µ—Ñ–∏–ª—å—Ç—Ä
  - `_simple_candidate_pages()` ‚Üí –≤—ã–±–æ—Ä –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü
  - `find_contradictions()` ‚Üí Stage 4 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è `STAGE4_ENABLED`)
  - `normalize_status_confidence()` ‚Üí –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –æ—Ç LLM

### Frontend
- ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:
  - `Header` ‚Üí –≤ App.tsx
  - `RequirementList` ‚Üí –≤ App.tsx
  - `PdfViewer` ‚Üí –≤ App.tsx
  - `RequirementEditor` ‚Üí –≤ App.tsx

- ‚úÖ `reportWebVitals()` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ index.tsx

---

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ—Å—Ç–∏

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—É–¥–∞–ª–∏—Ç—å/–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å)
1. ‚ùå **`TU_PROMPTS` + `load_tu_prompts()`** - —Ç–æ—á–Ω–æ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∑–∞–Ω–∏–º–∞–µ—Ç –ø–∞–º—è—Ç—å

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—Ä–µ—à–∏—Ç—å, –Ω—É–∂–Ω–æ –ª–∏)
2. ‚ö†Ô∏è **`recommendations`** - backend –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç, frontend –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç (–º–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é)

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—Ç–µ—Ö–¥–æ–ª–≥)
3. ‚ö†Ô∏è **`trace_id`** - –º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

## üõ†Ô∏è –î–µ–π—Å—Ç–≤–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏

### –ï—Å–ª–∏ —Ä–µ—à–µ–Ω–æ —É–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ:

```bash
# 1. –£–¥–∞–ª–∏—Ç—å TU_PROMPTS
# –í api-service/analysis_api_hybrid.py:
# - –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ 96-116 (—Ñ—É–Ω–∫—Ü–∏—è load_tu_prompts)
# - –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É 162 (TU_PROMPTS = ...)

# 2. –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª—ã –¢–£
rm prompts/tu_fe.txt
rm prompts/tu_ep.txt

# 3. –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
# –í ui-react-service/src/types.ts - —É–¥–∞–ª–∏—Ç—å:
# - recommendations: string
# - trace_id?: string
```

---

## üìà –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

- **–û–±—â–∞—è —á–∏—Å—Ç–æ—Ç–∞ –∫–æ–¥–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ (4/5)
- **–°–≤—è–∑–Ω–æ—Å—Ç—å:** –û—Ç–ª–∏—á–Ω–∞—è (–≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–≤—è–∑–∞–Ω—ã, –º–∏–Ω–∏–º—É–º –º–µ—Ä—Ç–≤–æ–≥–æ –∫–æ–¥–∞)
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è:** –•–æ—Ä–æ—à–∞—è (TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –ø–æ–ª–Ω—ã–µ, –Ω–æ –µ—Å—Ç—å –ª–∏—à–Ω–∏–µ –ø–æ–ª—è)
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ï—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª (TU_PROMPTS –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∑—Ä—è)

**–í—ã–≤–æ–¥:** –ö–æ–¥ –≤ —Ü–µ–ª–æ–º —á–∏—Å—Ç—ã–π –∏ —Ö–æ—Ä–æ—à–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–π. –ù–∞–π–¥–µ–Ω–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ.
