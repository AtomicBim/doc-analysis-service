# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–≤

## üìä –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π (extraction_status)**

#### –î–æ:
- –ü—Ä–æ—Å—Ç—ã–µ —Å—Ç–∞—Ç—É—Å—ã –±–µ–∑ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –¢–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ–Ω—Ç –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞–¥–∏–∏

#### –ü–æ—Å–ª–µ:
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `details` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ KB
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

**–ü—Ä–∏–º–µ—Ä:**
```
–≠—Ç–∞–ø 1/2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞
–†–∞–∑–º–µ—Ä: 245.3 KB

–≠—Ç–∞–ø 2/2: –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π —á–µ—Ä–µ–∑ AI
–ù–∞–π–¥–µ–Ω–æ 18 —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
```

---

### 2. **–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ (analysis_status)**

#### –ù–æ–≤–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:

| Stage | –ü—Ä–æ–≥—Ä–µ—Å—Å | –ß—Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|---------------|----------|
| **Stage 1** | 0-20% (20%) | –ü–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º | –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑ —à—Ç–∞–º–ø–æ–≤ |
| **Stage 2** | 20-35% (15%) | –ü–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º | –û—Ü–µ–Ω–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü |
| **Stage 3** | 35-100% (65%) | **–ü–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º** | –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–∞–∂–¥–æ–≥–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è |

#### –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:

```python
def calculate_stage_progress(stage_num: int, processed: int, total: int) -> int:
    if stage_num == 1:
        # Stage 1: 0-20%
        return min(int((processed / total * 20)), 20)
    elif stage_num == 2:
        # Stage 2: 20-35% (15% –¥–∏–∞–ø–∞–∑–æ–Ω)
        return min(int(20 + (processed / total * 15)), 35)
    elif stage_num == 3:
        # Stage 3: 35-100% (65% –¥–∏–∞–ø–∞–∑–æ–Ω)
        return min(int(35 + (processed / total * 65)), 100)
```

#### –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ —Å—Ç–∞—Ç—É—Å:
- ‚úÖ `total_pages` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü
- ‚úÖ `total_requirements` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
- ‚úÖ `processed_items` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- ‚úÖ `details` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ

**–ü—Ä–∏–º–µ—Ä:**
```
–≠—Ç–∞–ø 3/3: –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π (45%)
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ 8/18 —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π (–≥—Ä—É–ø–ø–∞ 3/5)
```

---

### 3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ Stage 3**

#### –î–æ:
```python
# –ü—Ä–æ–≥—Ä–µ—Å—Å —Å—á–∏—Ç–∞–ª—Å—è –ø–æ –≥—Ä—É–ø–ø–∞–º (–Ω–µ—Ç–æ—á–Ω–æ)
progress = 70 + int((group_idx / total_groups) * 25)
```

#### –ü–æ—Å–ª–µ:
```python
# –ü—Ä–æ–≥—Ä–µ—Å—Å —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º (—Ç–æ—á–Ω–æ)
processed_reqs = len(analyzed_reqs)
progress = calculate_stage_progress(3, processed_reqs, total_reqs)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –¢–æ—á–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- ‚úÖ –õ–∏–Ω–µ–π–Ω—ã–π —Ä–æ—Å—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–∞ (–Ω–µ —Å–∫–∞—á–∫–∞–º–∏)
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç, —Å–∫–æ–ª—å–∫–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –æ—Å—Ç–∞–ª–æ—Å—å

---

### 4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI**

#### –î–æ–±–∞–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–µ—Ç–∞–ª–µ–π:

```tsx
{/* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª–∏ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã */}
{realTimeStatus && realTimeStatus.details && (
  <div className="progress-details">
    <small>{realTimeStatus.details}</small>
  </div>
)}
```

#### –°—Ç–∏–ª–∏:
```css
.progress-details {
  margin-top: 0.5rem;
  padding: 0.5rem 1rem;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 6px;
  text-align: center;
}
```

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π:
1. **5%** - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–º—è —Ñ–∞–π–ª–∞)
2. **20%** - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –≤ KB)
3. **50%** - –¢–µ–∫—Å—Ç –∏–∑–≤–ª–µ—á–µ–Ω (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤)
4. **60%** - –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ AI
5. **90%** - –ù–∞–π–¥–µ–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
6. **100%** - –ó–∞–≤–µ—Ä—à–µ–Ω–æ

### –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞:
1. **0-20%** - Stage 1: –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º)
2. **20-35%** - Stage 2: –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å (–ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º)
3. **35-100%** - Stage 3: –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (**–ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º**)

---

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

1. **`update_extraction_status(stage_num, stage_name, progress, details="")`**
   - –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ `details`

2. **`update_analysis_status(stage_num, stage_name, progress, details="")`**
   - –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–µ–∫—Ç–∞
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ `details`

3. **`init_analysis_status(total_pages, total_requirements)`**
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∞–Ω–∞–ª–∏–∑ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ä–∞–∑–º–µ—Ä–µ –∑–∞–¥–∞—á–∏

4. **`calculate_stage_progress(stage_num, processed, total)`**
   - –í—ã—á–∏—Å–ª—è–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—É–ª–µ (20%, 15%, 65%)

### API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:

- `GET /extraction_status` - —Å—Ç–∞—Ç—É—Å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
- `GET /status` - —Å—Ç–∞—Ç—É—Å –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞:

```json
{
  "current_stage": 3,
  "progress": 67,
  "stage_name": "–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π",
  "total_stages": 3,
  "is_running": true,
  "total_pages": 45,
  "total_requirements": 18,
  "processed_items": 12,
  "details": "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ 12/18 —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π (–≥—Ä—É–ø–ø–∞ 3/5)"
}
```

---

## ‚úÖ –ò—Ç–æ–≥–æ

- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
- ‚úÖ –¢–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º (–Ω–µ –ø–æ –≥—Ä—É–ø–ø–∞–º)
- ‚úÖ –ù–æ–≤–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: 20%, 15%, 65%
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ
- ‚úÖ –ë–µ–∑ –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞

